[
  {
    "id": "tc-tbp-001",
    "name": "Top 10 Browsed Products - With PPL Parse Documentation",
    "description": "Test if agent can generate correct PPL parse command when PPL documentation is provided in context.",
    "category": "Top 10 Browsed Products",
    "subcategory": "With Context",
    "difficulty": "Medium",
    "initialPrompt": "What are the top 10 most browsed products?",
    "tools": [
      {
        "name": "execute_ppl_query",
        "description": "Update the query bar with a PPL query and optionally execute it",
        "parameters": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "The PPL query to set in the query bar"
            },
            "autoExecute": {
              "type": "boolean",
              "description": "Whether to automatically execute the query (default: true)"
            },
            "description": {
              "type": "string",
              "description": "Optional description of what the query does"
            }
          },
          "required": ["query"]
        }
      }
    ],
    "context": [
      {
        "description": "Explore application page context",
        "value": "{\"appId\":\"explore\",\"timeRange\":{\"from\":\"now-24h\",\"to\":\"now\"},\"query\":{\"query\":\"\",\"language\":\"PPL\"},\"dataset\":{\"dataSource\":{\"id\":\"otel-playground\",\"type\":\"OpenSearch\"},\"id\":\"logs-otel-v1\",\"timeFieldName\":\"time\",\"title\":\"logs-otel-v1*\",\"type\":\"INDEX_PATTERN\"}}"
      },
      {
        "description": "Sample log messages from this index",
        "value": "[\"User browsing product: 6E92ZMYYFZ\", \"User browsing product: L9ECAV7KIM\", \"User browsing product: OLJCESPC7Z\"]"
      },
      {
        "description": "Index field mappings",
        "value": "{\"body\":\"text field containing log messages\",\"severityText\":\"keyword - INFO/ERROR/WARN\",\"time\":\"timestamp field\",\"resource.attributes.service.name\":\"service name\"}"
      },
      {
        "description": "PPL Parse Command Documentation",
        "value": "The parse command extracts fields from text using regex patterns.\n\nSyntax: parse <field> '<pattern>'\n\nKey rules:\n1. Use Java regex named capture groups: (?<fieldName>pattern)\n2. Field names MUST use camelCase (letters and digits only) - NO underscores allowed\n3. Example: parse body 'User browsing product: (?<productId>\\w+)'\n4. Extracted fields can be used in subsequent commands like stats, sort, fields\n\nCommon patterns:\n- \\w+ matches word characters\n- \\d+ matches digits\n- [a-f0-9-]+ matches UUID characters\n\nExample query:\nsource = logs-otel-v1* | where body like 'User browsing product:%' | parse body 'User browsing product: (?<productId>\\w+)' | stats count() as cnt by productId | sort - cnt | head 10"
      }
    ],
    "expectedPPL": "source = logs-otel-v1* | where body like 'User browsing product:%' | parse body 'User browsing product: (?<productId>\\w+)' | stats count() as cnt by productId | sort - cnt | head 10",
    "expectedTrajectory": [
      {
        "step": 1,
        "description": "Generate PPL query using parse command: source = logs-otel-v1* | where body like 'User browsing product:%' | parse body 'User browsing product: (?<productId>\\w+)' | stats count() as cnt by productId | sort - cnt | head 10",
        "requiredTools": ["execute_ppl_query"]
      }
    ]
  },
  {
    "id": "tc-tbp-002",
    "name": "Top 10 Browsed Products - Without PPL Parse Documentation",
    "description": "Test if agent can generate correct PPL parse command WITHOUT PPL documentation - relying on model's built-in knowledge.",
    "category": "Top 10 Browsed Products",
    "subcategory": "Without Context",
    "difficulty": "Hard",
    "initialPrompt": "What are the top 10 most browsed products?",
    "tools": [
      {
        "name": "execute_ppl_query",
        "description": "Update the query bar with a PPL query and optionally execute it",
        "parameters": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "The PPL query to set in the query bar"
            },
            "autoExecute": {
              "type": "boolean",
              "description": "Whether to automatically execute the query (default: true)"
            },
            "description": {
              "type": "string",
              "description": "Optional description of what the query does"
            }
          },
          "required": ["query"]
        }
      }
    ],
    "context": [
      {
        "description": "Explore application page context",
        "value": "{\"appId\":\"explore\",\"timeRange\":{\"from\":\"now-24h\",\"to\":\"now\"},\"query\":{\"query\":\"\",\"language\":\"PPL\"},\"dataset\":{\"dataSource\":{\"id\":\"otel-playground\",\"type\":\"OpenSearch\"},\"id\":\"logs-otel-v1\",\"timeFieldName\":\"time\",\"title\":\"logs-otel-v1*\",\"type\":\"INDEX_PATTERN\"}}"
      },
      {
        "description": "Sample log messages from this index",
        "value": "[\"User browsing product: 6E92ZMYYFZ\", \"User browsing product: L9ECAV7KIM\", \"User browsing product: OLJCESPC7Z\"]"
      },
      {
        "description": "Index field mappings",
        "value": "{\"body\":\"text field containing log messages\",\"severityText\":\"keyword - INFO/ERROR/WARN\",\"time\":\"timestamp field\"}"
      }
    ],
    "expectedPPL": "source = logs-otel-v1* | where body like 'User browsing product:%' | parse body 'User browsing product: (?<productId>\\w+)' | stats count() as cnt by productId | sort - cnt | head 10",
    "expectedTrajectory": [
      {
        "step": 1,
        "description": "Generate PPL query using parse command: source = logs-otel-v1* | where body like 'User browsing product:%' | parse body 'User browsing product: (?<productId>\\w+)' | stats count() as cnt by productId | sort - cnt | head 10",
        "requiredTools": ["execute_ppl_query"]
      }
    ]
  }
]
